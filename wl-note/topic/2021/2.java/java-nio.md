
#  nio 知识点整理

这里有份脑图：[nio脑图](../../../etc/mind/NIO.xmind)

## 问题？
1. **NIO 与普通IO 有啥区别，为啥说nio效率更高？**

   NIO是指nonblocking I/O。也就是非阻塞IO,这种非阻塞IO体现在以下两个方面

   A: 数据存取标的上，NIO 是面上缓冲区的（Buffer）,而这个缓冲区（大块数据）,BIO 更喜欢操作的是小块数据，单个字节、几行文本。本身都各有所长，但是操作系统在硬件直接存储器存取DMA的协助下，更倾向于移动大块数据（缓冲区），所以当操作系统送来镇魂冲区的数据的时候。Bio的流数据内在花大量的时间把它们拆成小块。就会显得效率很与此相反。NiO。他操作的就是缓冲区。就能够轻松的把操作系统送来的数据。备份到我们能直接使用的地方（ByteBuffer）

   B: 数据传递连接方式上，IO的阻塞最大的体现其实就是传输，当客户端发起一个请求之后，它就会阻塞住，然后等待服务器处理；当服务器接受到请求之后它也会阻塞住知道任务处理完，那么当客户端很多的时候，服务端的线程不够用时，客户端的某些链接就需要等待了。但是NIO 用到的一种技术时IO多路复用（epull ），逻辑很简单就是分工合作，线程能够重复利用，那么这样做之后就大大提高了线程处理能力，降低了多个线程直降相互切换的时间损耗。

   IO多路复用技术请查看[IO多路复用技术](https://mp.weixin.qq.com/s/Ok7SIROXu1THUbWsFu-UYw)

## nio 计算机相关
###  缓冲区的操作
缓冲区以及缓冲区如何工作是所有io的基础。所谓io就是输入输出的意思，无非是把数据移进或者移出缓冲区。
进程执行io操作归结起来，也就是向操作系统发出请求，让他要么把缓冲区里的数据排干（写）。要么用数据把缓冲区填满（读）

### 内核空间与用户空间
### 虚拟内存
### 分页技术
### 面向文件的IO 和流IO
## api

Nio 中三剑客 Buffer Channel Selector

### Buffer
> 理解：
> Buffer ：一个buffer对象是固定数量的数据的容器，其作用是一个存储器，或者分段运输器,相当于Java中的List,在这里，数据可被存储并在之后用于检索。十分善于处理字节。非字节缓冲区可以在后台执行从字节。或到自己的转换。

缓冲区的工作，与通道（Channel）紧密联系。通道是io传输发生时通过的入口，而缓冲区是这些数据传输的来源或目标,对于离开缓冲区的传输。传递出去的数据被置于一个缓冲区,被传送到通道;对于传输回缓冲区的传输,一个通道将数据放置在您所提供的缓冲区中。
这种在协同对象之前进行的缓冲区数据传递是高效数据处理的关键。

缓冲区(Buffer)并不是多线程安全的，如果你想以多线程同时存取特定的缓冲区，您需要在存取Buffer之前进行同步。

*Buffer基础*

**属性**：
**Capacity**:  缓冲区能够容纳的数据元素的最大。数量这一容量在缓冲区创建时被设定，并且永远不能被改变。
**Limit**:  缓冲区的第一个不能被读或写的元素。或者说缓冲区中现存元素的计数。
**Position**： 下一个要被读或写的元素的位置。位置会自动由相应的get和put函数更新。
**Mark**:  一个备忘位置。
0<=mark<=position<=limit<=capacity

> 一旦缓冲区对象完成填充。并释放它就可以被重新使用了。
> 

### channel

### selector